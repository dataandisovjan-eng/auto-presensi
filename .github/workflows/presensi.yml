name: Auto Presensi

on:
  workflow_dispatch:   # ‚úÖ Bisa dijalankan manual dari GitHub Actions
    inputs:
      user:
        description: "Pilih user (contoh: USER1)"
        required: false
        default: "USER1"
      mode:
        description: "Pilih mode (check_in / check_out)"
        required: false
        default: "check_in"

  schedule:            # ‚úÖ Jalan otomatis setiap hari
    - cron: "30 22 * * *"    # Jam 05:30 WIB ‚Üí check_in
    - cron: "5 9 * * *"      # Jam 16:05 WIB ‚Üí check_out

jobs:
  presensi:
    runs-on: ubuntu-latest

    steps:
      - name: üìÇ Checkout repository
        uses: actions/checkout@v4

      - name: üêç Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      - name: üì¶ Install dependencies
        run: |
          pip install selenium webdriver-manager

      - name: ‚ñ∂Ô∏è Jalankan presensi
        env:
          USER1_USERNAME: ${{ secrets.USER1_USERNAME }}
          USER1_PASSWORD: ${{ secrets.USER1_PASSWORD }}
          USER2_USERNAME: ${{ secrets.USER2_USERNAME }}
          USER2_PASSWORD: ${{ secrets.USER2_PASSWORD }}
        run: |
          echo "‚è∞ Mulai presensi..."
          python main.py \
            --user "${{ github.event.inputs.user || 'USER1' }}" \
            --mode "${{ github.event.inputs.mode || 'check_in' }}"

      - name: üì§ Upload logs & screenshot
        uses: actions/upload-artifact@v4
        if: always()
        with:
          name: presensi-artifacts
          path: |
            *.log
            *.png
            artifacts/
